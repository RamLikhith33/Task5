const PRODUCTS=[{id:1,name:"Smartphone X",category:"electronics",price:599,rating:4.6,img:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?q=80&w=800&auto=format&fit=crop"},{id:2,name:"Laptop Pro",category:"electronics",price:1299,rating:4.8,img:"https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=800&auto=format&fit=crop"},{id:3,name:"Running Shoes",category:"clothing",price:89,rating:4.3,img:"https://images.unsplash.com/photo-1520975911594-8d0f5c9b2b8f?q=80&w=800&auto=format&fit=crop"},{id:4,name:"T-Shirt",category:"clothing",price:19,rating:4.1,img:"https://images.unsplash.com/photo-1520975698517-40b7c7b5f3a6?q=80&w=800&auto=format&fit=crop"},{id:5,name:"Headphones",category:"electronics",price:119,rating:4.5,img:"https://images.unsplash.com/photo-1518444022164-9cae4e3d7c79?q=80&w=800&auto=format&fit=crop"}],BLOGS=[{id:1,title:"Optimizing Web Performance",excerpt:"Techniques to make your site fast: critical CSS, resource prioritization, lazy-loading images, and caching strategies.",img:"https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1200&auto=format&fit=crop"},{id:2,title:"Responsive Design Patterns",excerpt:"Design for all devices using fluid grids, breakpoints, accessibility, and progressive enhancement.",img:"https://images.unsplash.com/photo-1504384308090-c894fdcc538d?q=80&w=1200&auto=format&fit=crop"}],$=s=>document.querySelector(s),$$=s=>Array.from(document.querySelectorAll(s));function renderProducts(list=PRODUCTS){const grid=$('#productGrid');grid.innerHTML='';const frag=document.createDocumentFragment();list.forEach(p=>{const card=document.createElement('article');card.className='product-card';card.innerHTML=`<img loading="lazy" alt="${p.name}" src="${p.img}"><h3>${p.name}</h3><div class="product-meta">Category: ${p.category} • ⭐ ${p.rating}</div><div class="product-actions"><div style="font-weight:600;margin-right:auto;">$${p.price.toFixed(2)}</div><button class="btn btn-ghost" data-id="${p.id}" onclick="addToCart(${p.id})">Add</button></div>`;frag.appendChild(card)});grid.appendChild(frag)}function renderBlogs(){const list=$('#blogList');list.innerHTML='';const frag=document.createDocumentFragment();BLOGS.forEach(b=>{const el=document.createElement('article');el.className='blog-post';el.innerHTML=`<h3>${b.title}</h3><p>${b.excerpt}</p>`;frag.appendChild(el)});list.appendChild(frag)}function populateCategoryFilter(){const sel=$('#categoryFilter');const cats=Array.from(new Set(['all',...PRODUCTS.map(p=>p.category)]));sel.innerHTML=cats.map(c=>`<option value="${c}">${c[0].toUpperCase()+c.slice(1)}</option>`).join('')}function filterAndSort(){const q=$('#searchInput').value.trim().toLowerCase(),cat=$('#categoryFilter').value,sort=$('#sortSelect').value;let out=PRODUCTS.filter(p=>(cat==='all'||p.category===cat)&&p.name.toLowerCase().includes(q));if(sort==='priceLowHigh')out.sort((a,b)=>a.price-b.price);if(sort==='priceHighLow')out.sort((a,b)=>b.price-a.price);if(sort==='ratingHighLow')out.sort((a,b)=>b.rating-a.rating?b.rating-a.rating:0);renderProducts(out)}const CART_KEY='finalapp_cart';function loadCart(){return JSON.parse(localStorage.getItem(CART_KEY)||'[]')}function saveCart(cart){localStorage.setItem(CART_KEY,JSON.stringify(cart));updateCartUI()}function addToCart(id){const prod=PRODUCTS.find(p=>p.id===id);if(!prod)return;const cart=loadCart();const existing=cart.find(i=>i.id===id);if(existing)existing.qty++;else cart.push({id:prod.id,name:prod.name,price:prod.price,qty:1});saveCart(cart)}function removeFromCart(id){let cart=loadCart().filter(i=>i.id!==id);saveCart(cart)}function clearCart(){saveCart([])}function updateCartUI(){const cart=loadCart();$('#cartCount').innerText=cart.reduce((s,i)=>s+i.qty,0);const items=$('#cartItems');if(!items) return;items.innerHTML=cart.length?cart.map(it=>`<li>${it.name} x${it.qty} — $${(it.price*it.qty).toFixed(2)} <button onclick="removeFromCart(${it.id})">Remove</button></li>`).join(''):'<li>(empty)</li>';$('#cartTotal').innerText=cart.reduce((s,i)=>s+i.price*i.qty,0).toFixed(2)}function openCart(){$('#cartPanel').setAttribute('aria-hidden','false')}function closeCart(){$('#cartPanel').setAttribute('aria-hidden','true')}function init(){populateCategoryFilter();renderProducts();renderBlogs();updateCartUI();$('#searchInput').addEventListener('input',throttle(filterAndSort,250));$('#categoryFilter').addEventListener('change',filterAndSort);$('#sortSelect').addEventListener('change',filterAndSort);$('#cartBtn').addEventListener('click',openCart);$('#closeCartBtn').addEventListener('click',closeCart);$('#clearCartBtn').addEventListener('click',clearCart);document.addEventListener('keydown',e=>{if(e.key==='Escape')closeCart()})}function throttle(fn,wait=200){let t=null;return function(...args){if(t) return; t=setTimeout(()=>{fn.apply(this,args); t=null;},wait)}}window.addToCart=addToCart;window.removeFromCart=removeFromCart;window.clearCart=clearCart;window.openCart=openCart;window.closeCart=closeCart;document.addEventListener('DOMContentLoaded',init);
